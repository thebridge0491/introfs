<?xml version="1.0" encoding="utf-8"?>
<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <Version Condition=" '$(Version)' =='' ">{{version}}{{^version}}0.1.0{{/version}}</Version>
    <Authors Condition=" '$(Authors)' =='' ">{{author}}{{^author}}{{repoacct}}{{^repoacct}}imcomputer{{/repoacct}}{{/author}}</Authors>
    <Company Condition=" '$(Company)' =='' ">org.sandbox</Company>
    <AssemblyTitle Condition=" '$(AssemblyTitle)' =='' ">$(AssemblyName)</AssemblyTitle>
    <Description Condition=" '$(Description)' =='' ">{{description}}{{^description}}Utilities sub-package for FSharp Intro examples project.{{/description}}</Description>
    <Copyright Condition=" '$(Copyright)' =='' ">Copyright (c) 2013, $(Authors)</Copyright>
    <PackageLicenseExpression Condition=" '$(PackageLicenseExpression)' =='' ">{{license}}{{^license}}Apache-2.0{{/license}}</PackageLicenseExpression>
    <PackageProjectUrl Condition=" '$(PackageProjectUrl)' =='' ">https://{{repohost}}{{^repohost}}bitbucket.org{{/repohost}}/{{repoacct}}{{^repoacct}}imcomputer{{/repoacct}}/{{parent}}{{^parent}}introfs{{/parent}}</PackageProjectUrl>
    <PackageTags Condition=" '$(PackageTags)' =='' ">demo intro development {{project}}{{^project}}util{{/project}}</PackageTags>
    <PackageReleaseNotes>Summary of changes made in this release of the package -- none.</PackageReleaseNotes>

    {{#executable}}<OutputType>exe</OutputType>{{/executable}}
    {{^executable}}<OutputType Condition=" '$(OutputType)' == '' ">library</OutputType>{{/executable}}
    <AssemblyOriginatorKeyFile Condition=" '$(OutputType)' == 'library' Or '$(OutputType)' == 'exe'">codesign.snk.pub</AssemblyOriginatorKeyFile>
    <SignAssembly Condition=" '$(AssemblyOriginatorKeyFile)' != '' ">true</SignAssembly>
    <DelaySign Condition=" '$(AssemblyOriginatorKeyFile)' != '' ">true</DelaySign>
    <ExeLauncher Condition=" '$(OS)' != 'Windows_NT' ">mono</ExeLauncher>
    <TargetFrameworks Condition=" '$(TargetFrameworks)' == '' ">{{^executable}}netstandard2.0;{{/executable}}net471{{^executable}};net461{{/executable}}</TargetFrameworks>

    <EnableDefaultCompileItems>false</EnableDefaultCompileItems>
    <AdditionalLibPaths>$(HOME)\nuget\packages</AdditionalLibPaths>
    {{#executable}}<StartupObject Condition=" '$(OutputType)' == 'exe' And '$(StartupObject)' == '' ">$(AssemblyName).App</StartupObject>{{/executable}}
    <GenerateDocumentationFile>true</GenerateDocumentationFile>
    <GeneratePackageOnBuild>true</GeneratePackageOnBuild>
    <!--<AutoGenerateBindingRedirects>true</AutoGenerateBindingRedirects>
    <GenerateBindingRedirectsOutputType>true</GenerateBindingRedirectsOutputType>-->
  </PropertyGroup>

  <ItemGroup>
    <PackageReference Include="microsoft.netframework.referenceassemblies" Version="1.0.0">
      <PrivateAssets>all</PrivateAssets>
      <IncludeAssets>runtime;build;native;contentfiles;analyzers</IncludeAssets>
    </PackageReference>
    <!--<Reference Include="netstandard.library" Condition=" 'netstandard2.0' == '$(TargetFramework)' ">
      <HintPath>$(HOME)\nuget\packages\NETStandard.Library\build\netstandard2.0\ref\netstandard.dll</HintPath>
    </Reference>-->
    <PackageReference Condition=" 'netstandard2.0' == '$(TargetFramework)' "
      Include="netstandard.library"/>
    <PackageReference Include="fsharp.core"/>
    <!--<PackageReference Include="log4net"/>-->
    <PackageReference Include="ini-parser-netstandard"/>
    {{#executable}}
    <PackageReference Include="system.diagnostics.textwritertracelistener"/>
    <PackageReference Include="mono.options"/>
    <PackageReference Include="newtonsoft.json"/>
    <PackageReference Include="yamldotnet"/>
    {{/executable}}
    <!--<PackageReference Include="mono.gendarme"/>-->
    <!--<PackageReference Include="ilrepack"/>-->

    <!--<Reference Include="{{parent}}{{^parent}}introfs{{/parent}}{{separator}}{{^separator}}.{{/separator}}{{project}}{{^project}}util{{/project}}">
      <HintPath Condition=" 'netcoreapp2.0' == '$(TargetFramework)' ">$(HOME)\nuget\packages\{{parentcap}}{{^parentcap}}Introfs{{/parentcap}}{{joiner}}{{^joiner}}.{{/joiner}}{{projectcap}}{{^projectcap}}Util{{/projectcap}}\lib\netstandard2.0\{{parentcap}}{{^parentcap}}Introfs{{/parentcap}}{{joiner}}{{^joiner}}.{{/joiner}}{{projectcap}}{{^projectcap}}Util{{/projectcap}}.dll</HintPath>
      <HintPath Condition=" 'netcoreapp2.0' != '$(TargetFramework)' ">$(HOME)\nuget\packages\{{parentcap}}{{^parentcap}}Introfs{{/parentcap}}{{joiner}}{{^joiner}}.{{/joiner}}{{projectcap}}{{^projectcap}}Util{{/projectcap}}\lib\$(TargetFramework)\{{parentcap}}{{^parentcap}}Introfs{{/parentcap}}{{joiner}}{{^joiner}}.{{/joiner}}{{projectcap}}{{^projectcap}}Util{{/projectcap}}.dll</HintPath>
    </Reference>
    <PackageReference Include="{{parent}}{{^parent}}introfs{{/parent}}{{separator}}{{^separator}}.{{/separator}}{{project}}{{^project}}util{{/project}}" Version="[{{version}}{{^version}}0.1.0{{/version}},)"/>-->
  </ItemGroup>

  <ItemGroup>
    <!--<ProjectReference Include="src\fs\*.*proj"/>-->
    <Content Include="LICENSE">
      <Pack>true</Pack>
      <PackagePath>LICENSE</PackagePath>
    </Content>
    <Content Include="resources\*.*"{{^executable}} Exclude="resources\App.config"{{/executable}}>
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
      <PackageCopyToOutput>true</PackageCopyToOutput>
    </Content>
    <EmbeddedResource Include="resources\*.*"{{^executable}} Exclude="resources\App.config"{{/executable}}>
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
      <LogicalName>$(AssemblyName).resources.%(filename)%(extension)</LogicalName>
    </EmbeddedResource>
    <!--<None Include="resources\*.*"{{^executable}} Exclude="resources\App.config"{{/executable}}>
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>-->
  </ItemGroup>
  <ItemGroup Condition=" 'netstandard2.0' == '$(TargetFramework)' ">
    <None Include="$(HOME)\nuget\packages\NETStandard.Library\build\netstandard2.0\ref\netstandard.dll">
      <Link>%(Filename)%(Extension)</Link>
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>
    <None Include="$(HOME)\nuget\packages\FSharp.Core\lib\netstandard2.0\FSharp.Core.dll">
      <Link>%(Filename)%(Extension)</Link>
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>
  </ItemGroup>

  <ItemGroup>
    <Compile Condition=" '$(OutputType)' == 'library' Or '$(OutputType)' == 'exe' "
      Include="src\**\*.fs" Exclude="src\**\App.fs"/>
    <Compile Condition=" '$(OutputType)' != 'library' And '$(OutputType)' != 'exe' "
      Include="src\**\*.fs" Exclude="src\**\App.fs;src\**\properties\*.fs"/>
    <!--<Compile Include="src\**\App.fs"/>-->
    <MixProjects Include="$(MSBuildProjectDirectory)\src\*\*.*proj"/>
  </ItemGroup>

  <!--<ItemGroup Condition=" '@(MixProjects)' != '' And '$(OutputType)' == 'module'">
    <AddModules Include="bin\$(Configuration)\net471\$(AssemblyName).netmodule"/>
    <AddModules Include="bin\$(Configuration)\net471\$(AssemblyName).*.netmodule"/>
  </ItemGroup>
  <ItemGroup Condition=" '@(MixProjects)' != '' And '$(OutputType)' != 'module'">
    <InputAssemblies Include="bin\$(Configuration)\net471\$(AssemblyName).exe" Condition=" '$(OutputType)' == 'exe' "/>
    <InputAssemblies Include="bin\$(Configuration)\net471\$(AssemblyName).dll" Condition=" '$(OutputType)' == 'library' "/>
    <InputAssemblies Include="bin\$(Configuration)\net471\$(AssemblyName).*.dll"/>
  </ItemGroup>-->

  <Import Project="targetsmsbuild\Tools.*.targets"/>
  <!--<Import Condition=" Exists('src\fs\$(AssemblyName).FSharp.fsproj') Or Exists('src\cs\$(AssemblyName).CSharp.csproj') "
    Project="targetsmsbuild\CombineProducts.targets"/>-->
  <!-- To modify your build process, add your task inside one of the targets
      below and uncomment it. Other similar extension points exist, see
      Microsoft.Common.targets. -->
  <!--<Target Name="BeforeBuild"></Target>
  <Target Name="AfterBuild"></Target>
  <Target Name="Help" DependsOnTargets="BeforeBuild">
    <Message Importance="High" Text="Visual Studio Version: $(VisualStudioVersion)"/>
    <Message Importance="High" Text="MS Build Bin Path: $(MSBuildBinPath)"/>
    <Message Importance="High" Text="MS Build Extensions Path: $(MSBuildExtensionsPath)"/>
    <Message Importance="High" Text="MS Build Project Directory: $(MSBuildProjectDirectory)\"/>
    <Exec Command="ls -lh bin\$(Configuration)\net471\"/>
    <Message Importance="High" Text=" "/>
  </Target>-->
  <Target Name="AfterClean">
	  <RemoveDir Directories="$(OutputPath);$(IntermediateOutputPath)"/>
  </Target>
  <Target Name="_BuildMixProjects" AfterTargets="BeforeBuild">
	  <MSBuild Projects="@(MixProjects)" RunEachTargetSeparately="true"
      Targets="Restore;Build" Properties="ParentProjectDir=$(MSBuildProjectDirectory)\"/>
  </Target>

</Project>
  <!-- display targets without leading underscore:
    msbuild /nologo /pp | sed -n '/^[ ]*<Target Name="[a-zA-Z]*"/ s|\(Target Name="[a-zA-Z]*"\).*|\1|p' | sort -->
  <!-- debug context: gdb -args mono -debug ... # lldb ; ddd -gdb; gdb
       valgrind context: valgrind -verbose -tool=memcheck -suppressions=resources/mono.supp mono -debug ...
  -->
  <!-- nuspec generated with msbuild /t:pack or msbuild /t:generatenuspec:
    msbuild [/p:nuspecoutpath=obj/$(Configuration)] /t:generatenuspec
  -->
